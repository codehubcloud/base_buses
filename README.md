# åµŒå…¥å¼æ€»çº¿é€šä¿¡åè®®åº“ (Embedded Bus Communication Protocol Library)

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Build Status](https://img.shields.io/badge/build-passing-brightgreen.svg)]()
[![Platform](https://img.shields.io/badge/platform-STM32%20%7C%20ESP32%20%7C%20Linux-blue.svg)]()

## é¡¹ç›®æ¦‚è¿° (Project Overview)

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„åµŒå…¥å¼ç³»ç»Ÿæ€»çº¿é€šä¿¡åè®®åº“ï¼Œæä¾›äº† 27 ç§å¸¸ç”¨é€šä¿¡åè®®å’Œæ€»çº¿æ¥å£çš„å®ç°ã€‚è¯¥é¡¹ç›®é‡‡ç”¨**ç¡¬ä»¶æŠ½è±¡å±‚(HAL)æ¨¡å¼**è®¾è®¡ï¼Œæ”¯æŒå¤šå¹³å°ç§»æ¤ï¼Œæ¯ä¸ªåè®®ç‹¬ç«‹ä¸ºä¸€ä¸ªæ¨¡å—ï¼Œä¾¿äºé›†æˆå’Œä½¿ç”¨ã€‚

**ä¸»è¦ç‰¹æ€§:**

- âœ… 27 ä¸ªç‹¬ç«‹é€šä¿¡åè®®æ¨¡å—
- âœ… æ”¯æŒ 4 å¤§å¹³å°: STM32F4ã€STM32F1ã€ESP32ã€Linux
- âœ… å®Œæ•´çš„ç¡¬ä»¶æŠ½è±¡å±‚(HAL)è®¾è®¡
- âœ… ä½¿ç”¨ securec å®‰å…¨å‡½æ•°åº“
- âœ… ä½¿ç”¨ä¸šç•Œçš„ä»£ç è§„èŒƒï¼Œç»“åˆGoogleçš„ä»£ç è§„èŒƒ,è¿›è¡Œä¸€äº›ä¿®æ”¹
- âœ… æ¯ä¸ªæ¨¡å—ç‹¬ç«‹ç¼–è¯‘ä¸ºé™æ€åº“
- âœ… å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹å’Œä½¿ç”¨ç¤ºä¾‹

[æŒç»­æ›´æ–°ä¸­...](https://github.com/codehubcloud/base_buses.git)

---

## ç›®å½•ç»“æ„ (Project Structure)

```
base_buses/
â”œâ”€â”€ 3rd_party/              # ç¬¬ä¸‰æ–¹åº“
â”‚   â””â”€â”€ securelib/          # securecå®‰å…¨åº“
â”œâ”€â”€ src/                    # æºä»£ç ç›®å½• (åè®®å®ç°)
â”‚   â”œâ”€â”€ uart/               # UART - é€šç”¨å¼‚æ­¥æ”¶å‘å™¨
â”‚   â”œâ”€â”€ spi/                # SPI - ä¸²è¡Œå¤–è®¾æ¥å£
â”‚   â”œâ”€â”€ i2c/                # I2C - ä¸¤çº¿åˆ¶æ€»çº¿
â”‚   â”œâ”€â”€ i3c/                # I3C - æ”¹è¿›å‹I3C
â”‚   â”œâ”€â”€ i2s/                # I2S - éŸ³é¢‘æ•°æ®æ¥å£
â”‚   â”œâ”€â”€ can/                # CAN - æ§åˆ¶å™¨å±€åŸŸç½‘
â”‚   â”œâ”€â”€ canfd/              # CAN FD - çµæ´»æ•°æ®é€Ÿç‡CAN
â”‚   â”œâ”€â”€ lin/                # LIN - å±€åŸŸäº’è¿ç½‘ç»œ
â”‚   â”œâ”€â”€ flexray/            # FlexRay - é«˜é€Ÿæ±½è½¦æ€»çº¿
â”‚   â”œâ”€â”€ modbus/             # Modbus - å·¥ä¸šåè®®
â”‚   â”œâ”€â”€ smbus/              # SMBus - ç³»ç»Ÿç®¡ç†æ€»çº¿
â”‚   â”œâ”€â”€ pmbus/              # PMBus - ç”µæºç®¡ç†æ€»çº¿
â”‚   â”œâ”€â”€ rs232/              # RS232 - æ ‡å‡†ä¸²å£
â”‚   â”œâ”€â”€ rs422/              # RS422 - å·®åˆ†ä¸²å£
â”‚   â”œâ”€â”€ rs485/              # RS485 - å¤šç‚¹é€šä¿¡æ€»çº¿
â”‚   â”œâ”€â”€ usb/                # USB - é€šç”¨ä¸²è¡Œæ€»çº¿
â”‚   â”œâ”€â”€ sdio/               # SDIO - SDå¡æ¥å£
â”‚   â”œâ”€â”€ onewire/            # 1-Wire - å•æ€»çº¿åè®®
â”‚   â”œâ”€â”€ ethernet/           # Ethernet - ä»¥å¤ªç½‘
â”‚   â”œâ”€â”€ pcie/               # PCIe - é«˜é€Ÿä¸²è¡Œæ€»çº¿
â”‚   â”œâ”€â”€ emmc/               # eMMC - åµŒå…¥å¼å­˜å‚¨
â”‚   â”œâ”€â”€ jtag/               # JTAG - è°ƒè¯•æ¥å£
â”‚   â”œâ”€â”€ swd/                # SWD - ä¸²è¡Œè°ƒè¯•æ¥å£
â”‚   â”œâ”€â”€ axi/                # AXI - ARMé«˜çº§æ€»çº¿
â”‚   â”œâ”€â”€ ahb/                # AHB - é«˜æ€§èƒ½æ€»çº¿
â”‚   â”œâ”€â”€ apb/                # APB - å¤–è®¾æ€»çº¿
â”‚   â”œâ”€â”€ dma/                # DMA - ç›´æ¥å†…å­˜è®¿é—®
â”‚   â”œâ”€â”€ platform_config.h   # å¹³å°é…ç½®å¤´æ–‡ä»¶
â”‚   â””â”€â”€ CMakeLists.txt      # æºç CMakeé…ç½®
â”œâ”€â”€ test/                   # æµ‹è¯•ç›®å½•
â”‚   â”œâ”€â”€ main.c              # æµ‹è¯•ä¸»å‡½æ•° (æ‰€æœ‰æ¨¡å—æµ‹è¯•)
â”‚   â”œâ”€â”€ CMakeLists.txt      # æµ‹è¯•CMakeé…ç½®
â”‚   â””â”€â”€ README.md           # æµ‹è¯•è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ CMakeLists.txt          # é¡¹ç›®æ ¹CMakeé…ç½®
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

---

## æ¨¡å—åˆ†ç±» (Module Categories)

### ğŸ”Œ ä¸²è¡Œé€šä¿¡åè®® (Serial Communication)

| æ¨¡å—       | è¯´æ˜           | åº”ç”¨åœºæ™¯        |
| ---------- | -------------- | --------------- |
| **UART**   | é€šç”¨å¼‚æ­¥æ”¶å‘å™¨ | MCU ä¸²å£é€šä¿¡    |
| **RS232**  | æ ‡å‡†ä¸²å£åè®®   | è®¡ç®—æœºå¤–è®¾é€šä¿¡  |
| **RS422**  | å·®åˆ†å…¨åŒå·¥ä¸²å£ | å·¥ä¸šé•¿è·ç¦»é€šä¿¡  |
| **RS485**  | å·®åˆ†åŠåŒå·¥å¤šç‚¹ | å·¥ä¸šæ€»çº¿ç½‘ç»œ    |
| **Modbus** | å·¥ä¸šé€šä¿¡åè®®   | PLCã€ä¼ æ„Ÿå™¨ç½‘ç»œ |

### ğŸšŒ åŒæ­¥æ€»çº¿åè®® (Synchronous Bus)

| æ¨¡å—      | è¯´æ˜         | åº”ç”¨åœºæ™¯       |
| --------- | ------------ | -------------- |
| **SPI**   | ä¸²è¡Œå¤–è®¾æ¥å£ | ä¼ æ„Ÿå™¨ã€å­˜å‚¨å™¨ |
| **I2C**   | ä¸¤çº¿åˆ¶æ€»çº¿   | ä¼ æ„Ÿå™¨ã€EEPROM |
| **I3C**   | æ”¹è¿›å‹ I3C   | é«˜é€Ÿä¼ æ„Ÿå™¨ç½‘ç»œ |
| **SMBus** | ç³»ç»Ÿç®¡ç†æ€»çº¿ | ç”µæ± ç®¡ç†ã€æ¸©æ§ |
| **PMBus** | ç”µæºç®¡ç†æ€»çº¿ | æ™ºèƒ½ç”µæºç®¡ç†   |
| **I2S**   | éŸ³é¢‘æ•°æ®æ¥å£ | éŸ³é¢‘ç¼–è§£ç å™¨   |

### ğŸš— æ±½è½¦æ€»çº¿åè®® (Automotive Bus)

| æ¨¡å—        | è¯´æ˜             | åº”ç”¨åœºæ™¯       |
| ----------- | ---------------- | -------------- |
| **CAN**     | æ§åˆ¶å™¨å±€åŸŸç½‘     | æ±½è½¦ ECU é€šä¿¡  |
| **CAN FD**  | çµæ´»æ•°æ®é€Ÿç‡ CAN | é«˜é€Ÿæ±½è½¦ç½‘ç»œ   |
| **LIN**     | å±€åŸŸäº’è¿ç½‘ç»œ     | ä½é€Ÿæ±½è½¦å­ç³»ç»Ÿ |
| **FlexRay** | æ—¶é—´è§¦å‘æ€»çº¿     | é«˜ç«¯æ±½è½¦åº•ç›˜   |

### ğŸ’¾ å­˜å‚¨ä¸é«˜é€Ÿæ¥å£ (Storage & High-Speed)

| æ¨¡å—     | è¯´æ˜         | åº”ç”¨åœºæ™¯     |
| -------- | ------------ | ------------ |
| **USB**  | é€šç”¨ä¸²è¡Œæ€»çº¿ | USB è®¾å¤‡é€šä¿¡ |
| **SDIO** | SD å¡æ¥å£    | SD å¡è¯»å†™    |
| **eMMC** | åµŒå…¥å¼å­˜å‚¨   | æ¿è½½é—ªå­˜     |
| **PCIe** | é«˜é€Ÿä¸²è¡Œæ€»çº¿ | é«˜é€Ÿå¤–è®¾æ‰©å±• |

### ğŸŒ ç½‘ç»œåè®® (Networking)

| æ¨¡å—         | è¯´æ˜       | åº”ç”¨åœºæ™¯   |
| ------------ | ---------- | ---------- |
| **Ethernet** | ä»¥å¤ªç½‘åè®® | ç½‘ç»œé€šä¿¡   |
| **1-Wire**   | å•æ€»çº¿åè®® | æ¸©åº¦ä¼ æ„Ÿå™¨ |

### ğŸ”§ è°ƒè¯•ä¸ç³»ç»Ÿæ€»çº¿ (Debug & System Bus)

| æ¨¡å—     | è¯´æ˜             | åº”ç”¨åœºæ™¯         |
| -------- | ---------------- | ---------------- |
| **JTAG** | è¾¹ç•Œæ‰«æè°ƒè¯•     | èŠ¯ç‰‡è°ƒè¯•ä¸‹è½½     |
| **SWD**  | ä¸²è¡Œè°ƒè¯•æ¥å£     | ARM è°ƒè¯•æ¥å£     |
| **AXI**  | ARM é«˜çº§æ‰©å±•æ€»çº¿ | SoC ç‰‡å†…é«˜é€Ÿæ€»çº¿ |
| **AHB**  | ARM é«˜æ€§èƒ½æ€»çº¿   | SoC é«˜é€Ÿå¤–è®¾     |
| **APB**  | ARM å¤–è®¾æ€»çº¿     | SoC ä½é€Ÿå¤–è®¾     |
| **DMA**  | ç›´æ¥å†…å­˜è®¿é—®     | é«˜é€Ÿæ•°æ®ä¼ è¾“     |

---

## å¹³å°æ”¯æŒ (Platform Support)

é¡¹ç›®é€šè¿‡æ¡ä»¶ç¼–è¯‘æ”¯æŒå¤šç§ç¡¬ä»¶å¹³å°:

| å¹³å°        | å®å®šä¹‰             | å¤„ç†å™¨æ¶æ„    | çŠ¶æ€        |
| ----------- | ------------------ | ------------- | ----------- |
| **STM32F4** | `PLATFORM_STM32F4` | ARM Cortex-M4 | âœ… å®Œå…¨æ”¯æŒ |
| **STM32F1** | `PLATFORM_STM32F1` | ARM Cortex-M3 | âœ… å®Œå…¨æ”¯æŒ |
| **ESP32**   | `PLATFORM_ESP32`   | Xtensa/RISC-V | âœ… å®Œå…¨æ”¯æŒ |
| **Linux**   | `PLATFORM_LINUX`   | x86/x64/ARM   | âœ… å®Œå…¨æ”¯æŒ |

### å¹³å°é…ç½®æ–‡ä»¶

æ‰€æœ‰å¹³å°é…ç½®é›†ä¸­åœ¨ `src/platform_config.h`ï¼Œé€šè¿‡ CMake ä¼ é€’å¹³å°å®å®šä¹‰ã€‚

---

## ç¼–è¯‘æ„å»º (Build Instructions)

### å‰ç½®è¦æ±‚ (Prerequisites)

- CMake >= 3.10
- GCC/Clang (Linux) æˆ– ARM-GCC (åµŒå…¥å¼)
- Make æˆ– Ninja

### æ ‡å‡†æ„å»º (Standard Build)

```bash
# Linuxå¹³å° (é»˜è®¤)
mkdir build && cd build
cmake ..
make
./bus_test
```

### å¹³å°é€‰æ‹©æ„å»º (Platform-Specific Build)

```bash
# STM32F4å¹³å°
cmake -DPLATFORM=STM32F4 ..
make

# STM32F1å¹³å°
cmake -DPLATFORM=STM32F1 ..
make

# ESP32å¹³å°
cmake -DPLATFORM=ESP32 ..
make

# Linuxå¹³å° (æ˜¾å¼æŒ‡å®š)
cmake -DPLATFORM=LINUX ..
make
```

### æ„å»ºç±»å‹ (Build Types)

```bash
# Debugæ„å»º (è°ƒè¯•ä¿¡æ¯ + é¢å¤–è­¦å‘Š)
cmake -DCMAKE_BUILD_TYPE=Debug ..

# Releaseæ„å»º (ä¼˜åŒ–)
cmake -DCMAKE_BUILD_TYPE=Release ..
```

### æ„å»ºé…ç½®è¯´æ˜

- **C æ ‡å‡†**: C99
- **ç¼–è¯‘å™¨é€‰é¡¹**:
  - Debug: `-g -Wall -Wextra`
  - Release: `-O2 -DNDEBUG`
- **ä¾èµ–åº“**: securec (è‡ªåŠ¨ç¼–è¯‘)
- **è¾“å‡º**: é™æ€åº“ + å¯æ‰§è¡Œæ–‡ä»¶

---

## ç¡¬ä»¶æŠ½è±¡å±‚(HAL)è®¾è®¡ (HAL Architecture)

### è®¾è®¡åŸåˆ™

é¡¹ç›®ä¸¥æ ¼éµå¾ª**åè®®å±‚ä¸ HAL å±‚åˆ†ç¦»**çš„åŸåˆ™:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åº”ç”¨å±‚ (Application Layer)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   åè®®å±‚ (Protocol Layer)           â”‚
â”‚   xxx.c / xxx.h                     â”‚
â”‚   - åè®®é€»è¾‘                        â”‚
â”‚   - çŠ¶æ€æœº                          â”‚
â”‚   - æ•°æ®å°è£…                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   HALå±‚ (Hardware Abstraction)      â”‚
â”‚   xxx_hal.c / xxx_hal.h             â”‚
â”‚   - å¯„å­˜å™¨æ“ä½œ                      â”‚
â”‚   - GPIOæ§åˆ¶                        â”‚
â”‚   - ä¸­æ–­å¤„ç†                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç¡¬ä»¶å±‚ (Hardware)                 â”‚
â”‚   STM32 / ESP32 / Linux             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### HAL å‡½æ•°å‘½åè§„èŒƒ

```c
// åè®®å±‚ (å¹³å°æ— å…³)
int32_t UartInit(void);              // UpperCamelCase
int32_t UartSendData(uint8_t data);

// HALå±‚ (å¹³å°ç›¸å…³)
void UartEnableClock(void);          // UpperCamelCase
void UartConfigureGpio(void);
uint8_t UartReadRegister(void);
```

### ç§»æ¤æ–°å¹³å°æ­¥éª¤

1. åœ¨ `src/platform_config.h` æ·»åŠ å¹³å°æ£€æµ‹
2. åœ¨å„æ¨¡å—çš„ `xxx_hal.c` æ·»åŠ å¹³å°æ¡ä»¶ç¼–è¯‘åˆ†æ”¯
3. å®ç°å¹³å°ç‰¹å®šçš„ HAL å‡½æ•°
4. æ›´æ–° `CMakeLists.txt` æ”¯æŒæ–°å¹³å°
5. **åè®®å±‚ä»£ç æ— éœ€ä¿®æ”¹**

---

## API æ¥å£æ–‡æ¡£ (API Reference)

### é€šç”¨å‡½æ•°æ¨¡å¼ (Common Function Patterns)

æ‰€æœ‰æ¨¡å—éµå¾ªä¸€è‡´çš„ API è®¾è®¡:

| å‡½æ•°ç±»å‹  | å‘½åæ¨¡å¼                             | è¿”å›å€¼                     | ç¤ºä¾‹                |
| --------- | ------------------------------------ | -------------------------- | ------------------- |
| åˆå§‹åŒ–    | `XxxInit()`                          | `int32_t` (0 æˆåŠŸ/-1 å¤±è´¥) | `UartInit()`        |
| å»åˆå§‹åŒ–  | `XxxDeinit()`                        | `int32_t`                  | `UartDeinit()`      |
| å‘é€æ•°æ®  | `XxxSendData()` / `XxxWriteData()`   | `int32_t`                  | `SpiSendData()`     |
| æ¥æ”¶æ•°æ®  | `XxxReceiveData()` / `XxxReadData()` | `int32_t`                  | `CanReceiveData()`  |
| é…ç½®å‚æ•°  | `XxxSetXxx()`                        | `int32_t`                  | `UartSetBaudRate()` |
| ä½¿èƒ½/ç¦ç”¨ | `XxxEnable()` / `XxxDisable()`       | `void`                     | `I2cEnable()`       |
| çŠ¶æ€æŸ¥è¯¢  | `XxxIsXxx()` / `XxxGetXxx()`         | `int32_t` / å…·ä½“ç±»å‹       | `SpiIsBusy()`       |

### ç¤ºä¾‹: UART æ¨¡å—

```c
#include "uart.h"

// åˆå§‹åŒ–UART
int32_t ret = UartInit();
if (ret != 0) {
    // é”™è¯¯å¤„ç†
}

// è®¾ç½®æ³¢ç‰¹ç‡
UartSetBaudRate(115200);

// å‘é€æ•°æ®
uint8_t data = 0x55;
UartSendData(data);

// æ¥æ”¶æ•°æ®
uint8_t rxData = 0;
ret = UartReceiveData(&rxData, 1);

// å¯ç”¨ä¸­æ–­
UartEnableInterrupts();
```

### ç¤ºä¾‹: CAN æ¨¡å—

```c
#include "can.h"

// åˆå§‹åŒ–CAN
CanInit();

// è®¾ç½®æ³¢ç‰¹ç‡ä¸º500Kbps
CanSetBaudRate(500000);

// å‘é€CANæ¶ˆæ¯
uint32_t canId = 0x123;
uint8_t data[8] = {0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08};
CanSendData(canId, data, 8);

// æ¥æ”¶CANæ¶ˆæ¯
uint8_t rxBuffer[8];
uint32_t rxId = 0;
int32_t len = CanReceiveData(&rxId, rxBuffer, 8);
```

### ç¤ºä¾‹: PMBus æ¨¡å—

```c
#include "pmbus.h"

// åˆå§‹åŒ–PMBus
PmBusInit();

// é€‰æ‹©ç”µæºè½¨0
PmBusSetPage(0);

// è¯»å–è¾“å‡ºç”µå‹
float voltage = PmBusReadVoltage();

// è¯»å–è¾“å‡ºç”µæµ
float current = PmBusReadCurrent();

// è®¾ç½®è¾“å‡ºç”µå‹ä¸º3.3V
PmBusSetVoltage(3.3f);

// è¯»å–çŠ¶æ€
uint16_t status = PmBusGetStatus();

// æ¸…é™¤æ•…éšœ
PmBusClearFaults();
```

---

## ä½¿ç”¨ç¤ºä¾‹ (Usage Examples)

æ¯ä¸ªæ¨¡å—éƒ½åœ¨ `test/main.c` ä¸­æä¾›äº†å®Œæ•´çš„æµ‹è¯•å‡½æ•°ã€‚

### æµ‹è¯•å‡½æ•°åˆ—è¡¨

```c
void TestUart(void);        // UARTæµ‹è¯•
void TestSpi(void);         // SPIæµ‹è¯•
void TestI2c(void);         // I2Cæµ‹è¯•
void TestI3c(void);         // I3Cæµ‹è¯•
void TestI2s(void);         // I2Sæµ‹è¯•
void TestCan(void);         // CANæµ‹è¯•
void TestCanFd(void);       // CAN FDæµ‹è¯•
void TestLin(void);         // LINæµ‹è¯•
void TestFlexRay(void);     // FlexRayæµ‹è¯•
void TestModbus(void);      // Modbusæµ‹è¯•
void TestSmBus(void);       // SMBusæµ‹è¯•
void TestPmBus(void);       // PMBusæµ‹è¯•
void TestRs232(void);       // RS232æµ‹è¯•
void TestRs422(void);       // RS422æµ‹è¯•
void TestRs485(void);       // RS485æµ‹è¯•
void TestUsb(void);         // USBæµ‹è¯•
void TestSdio(void);        // SDIOæµ‹è¯•
void TestOneWire(void);     // 1-Wireæµ‹è¯•
void TestEthernet(void);    // Ethernetæµ‹è¯•
void TestPcie(void);        // PCIeæµ‹è¯•
void TestEmmc(void);        // eMMCæµ‹è¯•
void TestJtag(void);        // JTAGæµ‹è¯•
void TestSwd(void);         // SWDæµ‹è¯•
void TestAxi(void);         // AXIæµ‹è¯•
void TestAhb(void);         // AHBæµ‹è¯•
void TestApb(void);         // APBæµ‹è¯•
void TestDma(void);         // DMAæµ‹è¯•
```

### è¿è¡Œæµ‹è¯•

```bash
cd build
./bus_test
```

è¯¦ç»†æµ‹è¯•è¯´æ˜è¯·å‚è€ƒ: `test/README.md`

---

## ç¼–ç è§„èŒƒ (Coding Standards)

### å‘½åè§„èŒƒ

- **å‡½æ•°å**: `UpperCamelCase` (å¤§é©¼å³°)
  - ç¤ºä¾‹: `UartInit()`, `SpiSendData()`
- **å˜é‡å/å‚æ•°å**: `lowerCamelCase` (å°é©¼å³°)
  - ç¤ºä¾‹: `int32_t dataLength`, `uint8_t* buffer`
- **å®å®šä¹‰**: `UPPER_CASE_WITH_UNDERSCORES`
  - ç¤ºä¾‹: `#define MAX_BUFFER_SIZE 256`
- **ç»“æ„ä½“/æšä¸¾**: `UpperCamelCase_E/S`
  - ç¤ºä¾‹: `typedef enum { ... } Status_E;`

### ä»£ç è§„èŒƒ

- âœ… æ‰€æœ‰æ§åˆ¶è¯­å¥å¿…é¡»ä½¿ç”¨èŠ±æ‹¬å·
- âœ… æ¯ä¸ªå‡½æ•°æœ€å¤š 50 è¡Œéç©ºéæ³¨é‡Šä»£ç 
- âœ… æ¯ä¸ªå‡½æ•°éƒ½æœ‰å®Œæ•´ Doxygen æ³¨é‡Š
- âœ… **æ‰€æœ‰å‡½æ•°è¿”å›å€¼å¿…é¡»æ£€æŸ¥**
- âœ… ä½¿ç”¨ securec å®‰å…¨å‡½æ•° (memcpy_s, strcpy_s ç­‰)
- âœ… è¿”å›å€¼: 0 è¡¨ç¤ºæˆåŠŸ, -1 è¡¨ç¤ºå¤±è´¥
- âœ… é”™è¯¯å¤„ç†: æ£€æŸ¥è¿”å›å€¼å¹¶é€‚å½“æ¸…ç†èµ„æº

### é”™è¯¯å¤„ç†ç¤ºä¾‹

```c
// âœ… æ­£ç¡®: æ£€æŸ¥è¿”å›å€¼
if (memcpy_s(dest, destSize, src, srcSize) != EOK) {
    return -1;
}

// âœ… æ­£ç¡®: æ£€æŸ¥ç³»ç»Ÿè°ƒç”¨
int fd = open("/dev/i2c-1", O_RDWR);
if (fd < 0) {
    // é”™è¯¯å¤„ç†
    return -1;
}

// âœ… æ­£ç¡®: èµ„æºæ¸…ç†
if (ioctl(fd, I2C_SLAVE, addr) < 0) {
    close(fd);  // æ¸…ç†å·²åˆ†é…èµ„æº
    return -1;
}
```

### æ³¨é‡Šè§„èŒƒ

```c
/******************************************************************************
 * @brief     : åˆå§‹åŒ–UARTå¤–è®¾
 * @param[in] : baudRate - æ³¢ç‰¹ç‡
 * @param[out]: None
 * @return    : 0 - æˆåŠŸ, -1 - å¤±è´¥
 * @note      : è°ƒç”¨æ­¤å‡½æ•°å‰éœ€è¦å…ˆä½¿èƒ½æ—¶é’Ÿ
 *****************************************************************************/
int32_t UartInit(uint32_t baudRate);
```

---

## é¡¹ç›®ç»Ÿè®¡ (Project Statistics)

- **æ€»æ¨¡å—æ•°**: 27 ä¸ª
- **æºæ–‡ä»¶æ•°**: 110+ (54 .c æ–‡ä»¶ + 56 .h æ–‡ä»¶)
- **ä»£ç è¡Œæ•°**: çº¦ 45,000 è¡Œ
- **æ”¯æŒå¹³å°**: 4 ä¸ª (STM32F4, STM32F1, ESP32, Linux)
- **ä¾èµ–åº“**: securec (å®‰å…¨å­—ç¬¦ä¸²åº“)
- **C æ ‡å‡†**: C99
- **æ„å»ºç³»ç»Ÿ**: CMake

---

## ä»£ç è´¨é‡ä¿è¯ (Quality Assurance)

### âœ… å·²å®Œæˆçš„è´¨é‡æ”¹è¿›

1. **æ‰€æœ‰ securec å‡½æ•°è¿”å›å€¼æ£€æŸ¥** (54+ å¤„ä¿®å¤)

   - memcpy_s, memset_s, strcpy_s, strncpy_s, sprintf_s

2. **æ‰€æœ‰ç³»ç»Ÿè°ƒç”¨è¿”å›å€¼æ£€æŸ¥** (47+ å¤„ä¿®å¤)

   - open(), ioctl(), read(), write(), bind()

3. **é”™è¯¯å¤„ç†æ¨¡å¼ç»Ÿä¸€**

   - å…³é”®æ“ä½œ: æ£€æŸ¥è¿”å›å€¼å¹¶æ¸…ç†èµ„æº
   - éå…³é”®æ“ä½œ: æ˜¾å¼æ ‡è®° `(void)` å¿½ç•¥è¿”å›å€¼

4. **èµ„æºç®¡ç†ä¼˜åŒ–**
   - å¤šèµ„æºåˆ†é…æ—¶çš„é€†åºæ¸…ç†
   - é”™è¯¯è·¯å¾„çš„èµ„æºé‡Šæ”¾
   - æ–‡ä»¶æè¿°ç¬¦çš„æ­£ç¡®å…³é—­

---

## æ–‡æ¡£èµ„æº (Documentation)

- **README.md** - é¡¹ç›®æ¦‚è¿°å’Œä½¿ç”¨è¯´æ˜ (æœ¬æ–‡æ¡£)
- **CLAUDE.md** - å¼€å‘è€…æŒ‡å—å’Œé¡¹ç›®é…ç½®
- **test/README.md** - æµ‹è¯•è¯´æ˜å’Œä½¿ç”¨æŒ‡å—
- **src/platform_config.h** - å¹³å°é…ç½®å‚è€ƒ

---

## å¸¸è§é—®é¢˜ (FAQ)

### Q1: å¦‚ä½•é€‰æ‹©åˆé€‚çš„é€šä¿¡åè®®?

- **çŸ­è·ç¦»ä½é€Ÿ**: UART, RS232
- **çŸ­è·ç¦»ä¼ æ„Ÿå™¨**: I2C, I3C, SMBus
- **é«˜é€Ÿå¤–è®¾**: SPI
- **å·¥ä¸šæ§åˆ¶**: RS485, Modbus
- **æ±½è½¦åº”ç”¨**: CAN, CAN FD, LIN, FlexRay
- **éŸ³é¢‘åº”ç”¨**: I2S
- **ç½‘ç»œé€šä¿¡**: Ethernet
- **ç”µæºç®¡ç†**: PMBus
- **ç‰‡å†…æ€»çº¿**: AXI, AHB, APB

### Q2: å¦‚ä½•ç§»æ¤åˆ°æ–°å¹³å°?

å‚è§ `å¤šå¹³å°HALå®ç°è¯´æ˜.md`ï¼ŒåŸºæœ¬æ­¥éª¤:

1. æ·»åŠ å¹³å°å®å®šä¹‰
2. å®ç° HAL å±‚å‡½æ•°
3. æ›´æ–° CMakeLists.txt
4. åè®®å±‚ä»£ç æ— éœ€ä¿®æ”¹

### Q3: å¦‚ä½•è°ƒè¯•?

- ä½¿ç”¨ Debug æ„å»º: `cmake -DCMAKE_BUILD_TYPE=Debug ..`
- æ£€æŸ¥è¿”å›å€¼
- å¯ç”¨æ—¥å¿—è¾“å‡º
- ä½¿ç”¨ JTAG/SWD è°ƒè¯•æ¥å£

### Q4: æ€§èƒ½ä¼˜åŒ–å»ºè®®?

- ä½¿ç”¨ Release æ„å»º
- å¯ç”¨ DMA ä¼ è¾“
- é…ç½®åˆé€‚çš„æ³¢ç‰¹ç‡/æ—¶é’Ÿé€Ÿåº¦
- ä½¿ç”¨ä¸­æ–­è€Œéè½®è¯¢
- æ‰¹é‡ä¼ è¾“æ•°æ®

---

## è´¡çŒ®æŒ‡å— (Contributing)

æ¬¢è¿è´¡çŒ®ä»£ç ! è¯·éµå¾ªä»¥ä¸‹è§„èŒƒ:

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/new-protocol`)
3. éµå¾ªé¡¹ç›®ç¼–ç è§„èŒƒ
4. æ·»åŠ æµ‹è¯•ç”¨ä¾‹
5. æäº¤ä»£ç  (`git commit -m 'Add new protocol'`)
6. æ¨é€åˆ†æ”¯ (`git push origin feature/new-protocol`)
7. åˆ›å»º Pull Request

---

## è®¸å¯è¯ (License)

MIT License - è¯¦è§ LICENSE æ–‡ä»¶

---

## è”ç³»æ–¹å¼ (Contact)

- **GitHub**: [https://github.com/codehubcloud/base_buses.git](https://github.com/codehubcloud/base_buses.git)
- **Issues**: æ¬¢è¿æäº¤é—®é¢˜å’Œå»ºè®®

---

## æ›´æ–°æ—¥å¿— (Changelog)

### v2.0.0 (2025-10-01)

- âœ… æ–°å¢ 17 ä¸ªé€šä¿¡åè®®æ¨¡å—
- âœ… å®Œæˆ 4 å¹³å° HAL å±‚é€‚é…
- âœ… å…¨é¢çš„è¿”å›å€¼æ£€æŸ¥å’Œé”™è¯¯å¤„ç†
- âœ… ä»£ç è§„èŒƒç»Ÿä¸€åŒ–
- âœ… å®Œå–„çš„æ–‡æ¡£å’Œç¤ºä¾‹

### v1.0.0 (2025-09-24)

- âœ… åˆå§‹ç‰ˆæœ¬
- âœ… å®ç°åŸºç¡€ 10 ä¸ªé€šä¿¡åè®®
- âœ… CMake æ„å»ºç³»ç»Ÿ
- âœ… securec å®‰å…¨åº“é›†æˆ

---

**æŒç»­æ›´æ–°ä¸­... æ¬¢è¿ Star å’Œ Fork!** â­
